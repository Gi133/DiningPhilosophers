version: 2.1

orbs:
    win: circleci/windows@2.4.0

jobs:
    linux-clang:
        machine:
            image: ubuntu-1604:201903-01
        environment:
              CC: clang-9
              CXX: clang++-9
              CXXFLAGS: -stdlib=libc++
        working_directory: ~/DiningPhilosophers
        steps:
            - add_ssh_keys:
                fingerprints:
                    - "ac:7c:61:b6:ae:20:a1:9f:15:48:68:9a:cc:9f:7d:f7"
            - checkout
            - run:
                name: Install Software
                command: |
                    sudo apt-get update
                    sudo apt-get install -y software-properties-common apt-transport-https curl
                    curl -s https://apt.llvm.org/llvm-snapshot.gpg.key | sudo apt-key add -
                    curl -s https://apt.kitware.com/keys/kitware-archive-latest.asc | sudo apt-key add -
                    sudo apt-add-repository -y 'deb http://apt.llvm.org/xenial/ llvm-toolchain-xenial-9 main'
                    sudo apt-add-repository -y 'deb https://apt.kitware.com/ubuntu/ xenial main'
                    sudo apt-get update
                    sudo apt-get install -y ninja-build git unzip cmake clang-9 libc++-9-dev libc++abi-9-dev
            - run:
                name: CMake
                command: |
                    cmake --version
                    mkdir build
                    cd ./build
                    cmake ..
                    make

#general:
 # build_dir: ./DiningPhilosophers


workflows:
    version: 2.1
    cmake-build:
        jobs:
            - linux-clang